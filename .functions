#!/usr/bin/env bash

ftrim() {
  case "$1" in 
    -h|--help)
      echo "Usage: ftrim [-b|-e] <bytes> <file>"
      echo "Remove N bytes from the beginning or end of the file"
      echo " "
      echo "options: "
      echo "-h|--help        Show this help"
      echo "-b|--begin       Remove bytes from the beginning"
      echo "-e|--end         Remove bytes from the end"
      ;;
    -b|--begin)
      bytes=$(($(/usr/bin/stat -f '%z' "${3}") - ${2}))
      tail -c $bytes "${3}"
      ;;
    -e|--end)
      bytes=$(($(/usr/bin/stat -f '%z' "${3}") - ${2}))
      head -c $bytes "${3}"
    ;;
    *)
      echo "Usage: ftrim [-b|-e] <bytes> <file>"
      echo "ftrim -h for more info"
      ;;
   esac
}

# Find short hand
f() {
  find . -name "${1}" 2>&1 | grep -v 'Permission denied'
}

# List all files, long format, colorized, permissions in octal
la(){
 	ls -l  "${@}" | awk '
    {
      k=0;
      for (i=0;i<=8;i++)
        k+=((substr($1,i+2,1)~/[rwx]/) *2^(8-i));
      if (k)
        printf("%0o ",k);
      printf(" %9s  %3s %2s %5s  %6s  %s %s %s\n", $3, $6, $7, $8, $5, $9,$10, $11);
    }'
}

# Copy w/ progress
cp_p () {
  rsync -WavP --human-readable --progress "${1}" "${2}"
}

# who is using the laptop's iSight camera?
camerausedby() {
	echo "Checking to see who is using the iSight cameraâ€¦ ðŸ“·"
	usedby=$(lsof | grep -w "AppleCamera\|USBVDC\|iSight" | awk '{printf $2"\n"}' | xargs ps)
	echo -e "Recent camera uses:\n${usedby}"
}

# Markdown previews
md() {
    pandoc "${1}" | lynx -stdin
}

ipls() {
  if [ "$(command -v ifconfig)" ]; then
    iplist=$(ifconfig | grep "inet" | grep -v "127.0.0.1" | grep -v "::1" | 
       cut -d" "  -f2 | cut -d"%" -f1 | sort)
  fi
 
  if [ -z "${1}" ]; then
      echo "${iplist}"
  fi

  if [ "${1}" = "-4" ]; then
    echo "${iplist}" | grep -v "::"
  fi

  if [ "${1}" = "-6" ]; then
    echo "${iplist}" | grep -v "\."
  fi
}

xor() {
  printf '%#x\n' "$((${1} ^ ${2}))"
}
